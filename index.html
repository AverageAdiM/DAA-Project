<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pattern Matching Visualizer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.4);
            padding: 40px;
        }

        h1 {
            text-align: center;
            color: #1e3c72;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .input-area {
            background: #f5f7fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 15px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        label {
            font-weight: bold;
            color: #333;
            font-size: 15px;
        }

        input[type="text"] {
            padding: 14px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 18px;
            font-family: 'Courier New', monospace;
            transition: all 0.3s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #1e3c72;
            box-shadow: 0 0 0 3px rgba(30, 60, 114, 0.1);
        }

        .controls-panel {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        select {
            padding: 12px 18px;
            border: 2px solid #1e3c72;
            border-radius: 8px;
            font-size: 15px;
            background: white;
            cursor: pointer;
            font-weight: bold;
            color: #1e3c72;
            transition: all 0.3s;
        }

        select:hover {
            background: #f0f4f8;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        .btn-play {
            background: #28a745;
            color: white;
        }

        .btn-play:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }

        .btn-pause {
            background: #ffc107;
            color: #333;
        }

        .btn-pause:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }

        .btn-reset {
            background: #dc3545;
            color: white;
        }

        .btn-reset:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .btn-step {
            background: #17a2b8;
            color: white;
        }

        .btn-step:hover {
            background: #138496;
            transform: translateY(-2px);
        }

        .speed-control {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-left: auto;
        }

        input[type="range"] {
            width: 180px;
            cursor: pointer;
        }

        .visualization-box {
            background: #f8f9fa;
            padding: 40px;
            border-radius: 12px;
            margin-bottom: 30px;
            min-height: 250px;
            border: 2px solid #e9ecef;
        }

        .text-row {
            font-family: 'Courier New', monospace;
            font-size: 28px;
            letter-spacing: 4px;
            margin-bottom: 50px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 4px;
        }

        .char-cell {
            width: 45px;
            height: 55px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #ccc;
            border-radius: 6px;
            background: white;
            transition: all 0.4s;
            position: relative;
        }

        .char-cell.active {
            background: #fff3cd;
            border-color: #ffc107;
            transform: scale(1.15);
            box-shadow: 0 4px 12px rgba(255, 193, 7, 0.4);
        }

        .char-cell.match {
            background: #d4edda;
            border-color: #28a745;
            transform: scale(1.1);
        }

        .char-cell.mismatch {
            background: #f8d7da;
            border-color: #dc3545;
            transform: scale(1.1);
        }

        .char-cell.found {
            background: #d1ecf1;
            border-color: #17a2b8;
            animation: bounce 0.6s;
        }

        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .pattern-row {
            font-family: 'Courier New', monospace;
            font-size: 28px;
            letter-spacing: 4px;
            display: flex;
            justify-content: center;
            margin-top: 30px;
            gap: 4px;
        }

        .status-bar {
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 8px;
            margin-top: 20px;
            font-weight: bold;
            font-size: 16px;
            text-align: center;
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-top: 30px;
        }

        .info-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            border: 2px solid #e9ecef;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .info-card h3 {
            color: #1e3c72;
            margin-bottom: 18px;
            font-size: 20px;
            border-bottom: 3px solid #1e3c72;
            padding-bottom: 10px;
        }

        .table-wrapper {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-family: 'Courier New', monospace;
        }

        th, td {
            border: 1px solid #dee2e6;
            padding: 12px;
            text-align: center;
            font-size: 15px;
        }

        th {
            background: #1e3c72;
            color: white;
            font-weight: bold;
        }

        td {
            background: white;
        }

        tr:hover td {
            background: #f8f9fa;
        }

        .algo-description {
            line-height: 1.8;
            color: #555;
        }

        .algo-description p {
            margin-bottom: 12px;
        }

        .algo-description strong {
            color: #1e3c72;
        }

        .matches-result {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            padding: 20px;
            border-radius: 8px;
            margin-top: 25px;
            border-left: 5px solid #28a745;
            display: none;
        }

        .matches-result h4 {
            color: #155724;
            margin-bottom: 12px;
            font-size: 18px;
        }

        .matches-result p {
            color: #155724;
            font-weight: bold;
            font-size: 16px;
        }

        .step-counter {
            background: #e9ecef;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            color: #495057;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Pattern Matching Visualizer</h1>
        <p class="subtitle">Watch KMP and Boyer-Moore algorithms in action!</p>
        
        <div class="input-area">
            <div class="input-row">
                <div class="input-group">
                    <label>Text String:</label>
                    <input type="text" id="textInput" value="ABABDABACDABABCABAB">
                </div>
                <div class="input-group">
                    <label>Pattern to Search:</label>
                    <input type="text" id="patternInput" value="ABABCABAB">
                </div>
            </div>
        </div>

        <div class="controls-panel">
            <select id="algoSelect">
                <option value="kmp">KMP Algorithm</option>
                <option value="boyermoore">Boyer-Moore Algorithm</option>
            </select>
            
            <button class="btn-play" id="playBtn">‚ñ∂ Play</button>
            <button class="btn-reset" id="resetBtn">‚Üª Reset</button>
            <button class="btn-step" id="stepBtn">‚è≠ Step</button>
            
            <span class="step-counter" id="stepCounter">Step: 0 / 0</span>

            <div class="speed-control">
                <label>Speed:</label>
                <input type="range" id="speedSlider" min="100" max="2000" value="1000" step="100">
                <span id="speedValue">1.0x</span>
            </div>
        </div>

        <div class="visualization-box">
            <div class="text-row" id="textDisplay"></div>
            <div class="pattern-row" id="patternDisplay"></div>
            <div class="status-bar" id="statusBar">Click Play to start visualization</div>
        </div>

        <div class="info-grid">
            <div class="info-card">
                <h3 id="tableHeader">LPS Array (KMP)</h3>
                <div class="table-wrapper" id="tableDisplay"></div>
            </div>
            <div class="info-card">
                <h3>Algorithm Information</h3>
                <div class="algo-description" id="algoDesc"></div>
            </div>
        </div>

        <div class="matches-result" id="matchesResult">
            <h4>‚úì Matches Found:</h4>
            <p id="matchesText"></p>
        </div>
    </div>

    <script>
        var textStr = 'ABABDABACDABABCABAB';
        var patternStr = 'ABABCABAB';
        var algo = 'kmp';
        var playing = false;
        var step = 0;
        var allSteps = [];
        var speedMs = 1000;
        var timer = null;
        var lps = [];
        var badChar = {};

        var textInput = document.getElementById('textInput');
        var patternInput = document.getElementById('patternInput');
        var algoSelect = document.getElementById('algoSelect');
        var playBtn = document.getElementById('playBtn');
        var resetBtn = document.getElementById('resetBtn');
        var stepBtn = document.getElementById('stepBtn');
        var speedSlider = document.getElementById('speedSlider');
        var speedValue = document.getElementById('speedValue');
        var textDisplay = document.getElementById('textDisplay');
        var patternDisplay = document.getElementById('patternDisplay');
        var statusBar = document.getElementById('statusBar');
        var tableDisplay = document.getElementById('tableDisplay');
        var tableHeader = document.getElementById('tableHeader');
        var algoDesc = document.getElementById('algoDesc');
        var matchesResult = document.getElementById('matchesResult');
        var matchesText = document.getElementById('matchesText');
        var stepCounter = document.getElementById('stepCounter');

        function computeLPS(pat) {
            var len = pat.length;
            var arr = [];
            for (var i = 0; i < len; i++) arr.push(0);
            var l = 0;
            var i = 1;
            while (i < len) {
                if (pat[i] === pat[l]) {
                    l++;
                    arr[i] = l;
                    i++;
                } else {
                    if (l !== 0) {
                        l = arr[l - 1];
                    } else {
                        arr[i] = 0;
                        i++;
                    }
                }
            }
            return arr;
        }

        function computeBadChar(pat) {
            var table = {};
            var len = pat.length;
            for (var i = 0; i < len - 1; i++) {
                table[pat[i]] = len - 1 - i;
            }
            return table;
        }

        function generateKMPSteps() {
            var steps = [];
            var lpsArr = computeLPS(patternStr);
            lps = lpsArr;
            var i = 0;
            var j = 0;
            var matches = [];

            while (i < textStr.length) {
                steps.push({
                    textIdx: i,
                    patIdx: j,
                    shift: i - j,
                    isComparing: true,
                    isMatch: textStr[i] === patternStr[j],
                    msg: 'Comparing text[' + i + ']=\'' + textStr[i] + '\' with pattern[' + j + ']=\'' + patternStr[j] + '\''
                });

                if (textStr[i] === patternStr[j]) {
                    i++;
                    j++;
                }

                if (j === patternStr.length) {
                    matches.push(i - j);
                    steps.push({
                        textIdx: i - 1,
                        patIdx: j - 1,
                        shift: i - j,
                        isFound: true,
                        msg: 'Pattern found at index ' + (i - j) + '!'
                    });
                    j = lpsArr[j - 1];
                } else if (i < textStr.length && textStr[i] !== patternStr[j]) {
                    if (j !== 0) {
                        j = lpsArr[j - 1];
                        steps.push({
                            textIdx: i,
                            patIdx: j,
                            shift: i - j,
                            isShift: true,
                            msg: 'Mismatch! Using LPS to shift pattern to position ' + j
                        });
                    } else {
                        i++;
                    }
                }
            }

            return { steps: steps, matches: matches };
        }

        function generateBoyerMooreSteps() {
            var steps = [];
            var bcTable = computeBadChar(patternStr);
            badChar = bcTable;
            var s = 0;
            var matches = [];

            while (s <= textStr.length - patternStr.length) {
                var j = patternStr.length - 1;

                while (j >= 0) {
                    steps.push({
                        textIdx: s + j,
                        patIdx: j,
                        shift: s,
                        isComparing: true,
                        isMatch: textStr[s + j] === patternStr[j],
                        msg: 'Comparing text[' + (s + j) + ']=\'' + textStr[s + j] + '\' with pattern[' + j + ']=\'' + patternStr[j] + '\''
                    });

                    if (textStr[s + j] !== patternStr[j]) {
                        break;
                    }
                    j--;
                }

                if (j < 0) {
                    matches.push(s);
                    steps.push({
                        textIdx: s + patternStr.length - 1,
                        patIdx: patternStr.length - 1,
                        shift: s,
                        isFound: true,
                        msg: 'Pattern found at index ' + s + '!'
                    });
                    s += 1;
                } else {
                    var shiftAmt = bcTable[textStr[s + j]] || patternStr.length;
                    steps.push({
                        textIdx: s + j,
                        patIdx: j,
                        shift: s,
                        isShift: true,
                        msg: 'Mismatch! Shifting pattern by ' + shiftAmt + ' positions'
                    });
                    s += shiftAmt;
                }
            }

            return { steps: steps, matches: matches };
        }

        function showLPSTable() {
            var html = '<table><thead><tr><th>Index</th>';
            for (var i = 0; i < patternStr.length; i++) {
                html += '<th>' + i + '</th>';
            }
            html += '</tr><tr><th>Pattern</th>';
            for (var i = 0; i < patternStr.length; i++) {
                html += '<th>' + patternStr[i] + '</th>';
            }
            html += '</tr></thead><tbody><tr><td><strong>LPS</strong></td>';
            for (var i = 0; i < lps.length; i++) {
                html += '<td>' + lps[i] + '</td>';
            }
            html += '</tr></tbody></table>';
            tableDisplay.innerHTML = html;
        }

        function showBadCharTable() {
            var keys = Object.keys(badChar);
            if (keys.length === 0) {
                tableDisplay.innerHTML = '<p>No bad character table</p>';
                return;
            }
            
            var html = '<table><thead><tr><th>Character</th>';
            for (var i = 0; i < keys.length; i++) {
                html += '<th>' + keys[i] + '</th>';
            }
            html += '<th>Others</th></tr></thead><tbody><tr><td><strong>Shift</strong></td>';
            for (var i = 0; i < keys.length; i++) {
                html += '<td>' + badChar[keys[i]] + '</td>';
            }
            html += '<td>' + patternStr.length + '</td></tr></tbody></table>';
            tableDisplay.innerHTML = html;
        }

        function renderVisualization() {
            if (allSteps.length === 0) return;

            var currentStep = allSteps[step];
            
            textDisplay.innerHTML = '';
            for (var i = 0; i < textStr.length; i++) {
                var cell = document.createElement('div');
                cell.className = 'char-cell';
                cell.textContent = textStr[i];
                
                if (currentStep.isFound && i >= currentStep.shift && i < currentStep.shift + patternStr.length) {
                    cell.classList.add('found');
                } else if (i === currentStep.textIdx && currentStep.isComparing) {
                    cell.classList.add(currentStep.isMatch ? 'match' : 'mismatch');
                } else if (i === currentStep.textIdx) {
                    cell.classList.add('active');
                }
                
                textDisplay.appendChild(cell);
            }

            patternDisplay.innerHTML = '';
            var offset = currentStep.shift;
            for (var i = 0; i < offset; i++) {
                var spacer = document.createElement('div');
                spacer.className = 'char-cell';
                spacer.style.visibility = 'hidden';
                patternDisplay.appendChild(spacer);
            }
            for (var i = 0; i < patternStr.length; i++) {
                var cell = document.createElement('div');
                cell.className = 'char-cell';
                cell.textContent = patternStr[i];
                
                if (i === currentStep.patIdx && currentStep.isComparing) {
                    cell.classList.add(currentStep.isMatch ? 'match' : 'mismatch');
                }
                
                patternDisplay.appendChild(cell);
            }

            statusBar.textContent = currentStep.msg;
            stepCounter.textContent = 'Step: ' + (step + 1) + ' / ' + allSteps.length;
        }

        function init() {
            textStr = textInput.value || 'ABABDABACDABABCABAB';
            patternStr = patternInput.value || 'ABABCABAB';
            algo = algoSelect.value;
            step = 0;
            playing = false;
            
            if (timer) {
                clearInterval(timer);
                timer = null;
            }

            playBtn.textContent = '‚ñ∂ Play';
            playBtn.className = 'btn-play';

            var result;
            if (algo === 'kmp') {
                result = generateKMPSteps();
                tableHeader.textContent = 'LPS Array (KMP)';
                showLPSTable();
                algoDesc.innerHTML = '<p><strong>Knuth-Morris-Pratt (KMP)</strong></p><p>Time Complexity: O(n + m)</p><p>Uses the Longest Prefix Suffix (LPS) array to avoid re-comparing characters after a mismatch.</p><p>The LPS array stores the length of the longest proper prefix which is also a suffix for each position in the pattern.</p>';
            } else {
                result = generateBoyerMooreSteps();
                tableHeader.textContent = 'Bad Character Table';
                showBadCharTable();
                algoDesc.innerHTML = '<p><strong>Boyer-Moore Algorithm</strong></p><p>Time Complexity: O(n/m) best case</p><p>Scans the pattern from right to left and uses the bad character rule to skip sections of the text.</p><p>The bad character table stores the rightmost occurrence of each character in the pattern.</p>';
            }

            allSteps = result.steps;
            
            if (result.matches.length > 0) {
                matchesResult.style.display = 'block';
                matchesText.textContent = 'Found at positions: ' + result.matches.join(', ');
            } else {
                matchesResult.style.display = 'none';
            }

            if (allSteps.length > 0) {
                renderVisualization();
            }
        }

        function togglePlay() {
            playing = !playing;
            
            if (playing) {
                playBtn.textContent = '‚è∏ Pause';
                playBtn.className = 'btn-pause';
                timer = setInterval(function() {
                    if (step < allSteps.length - 1) {
                        step++;
                        renderVisualization();
                    } else {
                        playing = false;
                        playBtn.textContent = '‚ñ∂ Play';
                        playBtn.className = 'btn-play';
                        clearInterval(timer);
                    }
                }, speedMs);
            } else {
                playBtn.textContent = '‚ñ∂ Play';
                playBtn.className = 'btn-play';
                if (timer) {
                    clearInterval(timer);
                    timer = null;
                }
            }
        }

        function stepForward() {
            if (step < allSteps.length - 1) {
                step++;
                renderVisualization();
            }
        }

        playBtn.addEventListener('click', togglePlay);
        resetBtn.addEventListener('click', init);
        stepBtn.addEventListener('click', stepForward);
        
        textInput.addEventListener('change', init);
        patternInput.addEventListener('change', init);
        algoSelect.addEventListener('change', init);
        
        speedSlider.addEventListener('input', function(e) {
            speedMs = 2100 - parseInt(e.target.value);
            speedValue.textContent = ((2100 - speedMs) / 1000).toFixed(1) + 'x';
            
            if (playing) {
                clearInterval(timer);
                timer = setInterval(function() {
                    if (step < allSteps.length - 1) {
                        step++;
                        renderVisualization();
                    } else {
                        playing = false;
                        playBtn.textContent = '‚ñ∂ Play';
                        playBtn.className = 'btn-play';
                        clearInterval(timer);
                    }
                }, speedMs);
            }
        });

        init();
    </script>
</body>
</html>
